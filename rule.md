# 電気椅子ゲームルール

2 人で戦うゼロサム有限ゲームです
プレイヤー 1 とプレイヤー 2 が対戦します。
1-12 の番号がふられた 12 脚の椅子を使用します。

## ゲームの状態

### 初期状態

- 現在のターン: 0
- 各椅子: すべて残存(1-12番すべてTRUE)
- 各プレイヤーの点数: 0点
- 各プレイヤーが受けた電流の回数: 0回

### 進行状態

- 現在のターン(0-15)
- 各椅子が残存しているか(TRUE/FALSE)
- 各プレイヤーの点数(0-39)
- 各プレイヤーが受けた電流の回数(0-2)

## ゲームの進行

### 各ターンで行われる内容

- プレイヤーは、攻撃側と防御側に分かれます。
  - 偶数ターン(0,2,...)
    - 攻撃:プレイヤー 1
    - 防御:プレイヤー 2
  - 奇数ターン(1,3,...)
    - 攻撃:プレイヤー 2
    - 防御:プレイヤー 1
- 攻撃側は、残存している椅子からちょうど 1 つ選択し、電流を仕掛けます。この選択はこの時点では防御側に伝わりません。
- 防御側は、残存している椅子からちょうど 1 つ選択します
- 互いの選択により盤面が遷移します。
  - 両者が選択した椅子が一致していた場合
    - **攻撃側**の点数が 0 になり、**攻撃側**の受けた電流の回数が 1 増える
    - 椅子は撤去されない
  - 両者が選択した椅子が一致していていない場合
    - **攻撃側**の点数が、**攻撃側が選択した**椅子の番号と等量増える(攻撃側が5 番の椅子を選択すれば 5 点)。また**攻撃側が選択した**椅子が撤去される。
- **攻撃側**が受けた電流の回数が 3 となった場合、**攻撃側**のプレイヤーの敗北が確定し、終了
- **攻撃側**の点数が 40 以上になった場合、**攻撃側**のプレイヤーの勝利が確定し、終了
- 残存する椅子が 1 個になった場合は、そのターンの処理（点数獲得等）を行った後にゲーム終了し、現在の点数が大きい方の勝利が確定する。同点の場合は引き分け。
- ターン 15 が終了した場合（計16ターン実行後）、現在の点数が大きい方の勝利が確定し、終了。同点の場合は引き分け。

## 評価システム

- プレイヤー1の勝利確定: +1点
- プレイヤー1の敗北確定: -1点  
- 引き分け確定: 0点（将来的に0.1点等に変更する可能性あり）
- 進行状態の評価値: 両プレイヤーが最適混合戦略を取った時のプレイヤー1目線での期待値

## 実装における重要な注意事項（2025年8月1日更新）

### システム統一化完了
2025年8月1日の修正により、**WebアプリケーションのUI表示とゲームロジックが完全に統一**されました：

#### 統一された役割定義
- **攻撃側**: 椅子を選択し電流を仕掛ける側（偶数ターンはプレイヤー1、奇数ターンはプレイヤー2）
- **防御側**: 椅子を選択し電気を避ける側（偶数ターンはプレイヤー2、奇数ターンはプレイヤー1）
- **得点・電流**: 攻撃側が受ける

#### ハッシュシステム更新
状態ハッシュのビット配置を変更（ターンが最上位ビットに配置）：
- bit 28-31: ターン数 (4ビット)
- bit 16-27: 椅子残存状態 (12ビット)
- bit 10-15: プレイヤー1点数 (6ビット)
- bit 4-9: プレイヤー2点数 (6ビット)
- bit 2-3: プレイヤー1電流回数 (2ビット)
- bit 0-1: プレイヤー2電流回数 (2ビット)

例：0xA0000000 = ターン10、椅子なし、点数・電流すべて0
